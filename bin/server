#!/usr/bin/env ruby
# frozen_string_literal: true

puts(__FILE__)

require 'socket'

require_relative '../lib/io'

trap('INT') do
  puts 'Shutting down...'
  exit
end

tcp_server = TCPServer.new(
  ENV.fetch('HOST'),
  ENV.fetch('PORT')
)

tcp_server.register(:read, :accept)

$stdout.flush
puts "Listening on port #{ENV.fetch('PORT')}!"
IO.reactor
