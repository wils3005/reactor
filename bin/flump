#!/usr/bin/env ruby
# frozen_string_literal: true

env =
  File
  .read('.env')
  .split("\n")
  .reject { |str| str =~ /^\s*#/ }
  .map { |str| str.split('=') }
  .to_h

ENV.merge!(env)

env_sample_keys =
  File
  .read('.env.sample')
  .split("\n")
  .map { |str| str[/^\w+/] }

missing_keys = (env_sample_keys - ENV.keys)

msg = "ENV values not set: #{missing_keys}"
abort(msg) unless missing_keys.empty?

require_relative '../lib/flump'
Flump.call
